---
// src/pages/index.astro
// Homepage - consiguetuvisa.com
// Optimizado: carga todos los datos de Sanity en paralelo

import Layout from '../components/global/Layout.astro';
import Hero from '../components/home/Hero.astro';
import Benefits from '../components/home/Benefits.astro';
import ServicesGrid from '../components/home/ServicesGrid.astro';
import Testimonials from '../components/home/Testimonials.astro';
import StepsFlow from '../components/home/StepsFlow.astro';
import Trust from '../components/home/Trust.astro';
import TrustLogos from '../components/home/TrustLogos.astro';
import FAQ from '../components/home/FAQ.astro';
import Contact from '../components/home/Contact.astro';
import { getHomepageData } from '$lib/sanity/homepage.service';
import type { FAQItem } from '$lib/sanity/faq.service';

// Cargar TODOS los datos en paralelo (antes eran 11 fetches secuenciales)
const data = await getHomepageData();

// FAQs para schema markup
const faqsForSchema = data.faq.items.map((item: FAQItem) => ({
  question: item.question,
  answer: item.answer,
}));
---

<Layout 
  title="Asesoría Profesional para Visas de Turismo"
  description="Asesoría profesional para visas de turismo. EE.UU, Canadá, México, Europa y más. Acompañamiento experto paso a paso."
  faqs={faqsForSchema}
  includeFAQSchema={true}
>
  <Hero data={data.hero} />
  <TrustLogos data={data.trustLogos} />
  <Benefits data={data.benefits} />
  <ServicesGrid data={data.services} />
  <Testimonials data={data.testimonials} />
  <StepsFlow data={data.steps} />
  <Trust data={data.trust} />
  <FAQ data={data.faq} />
  <Contact data={{ contact: data.contact, settings: data.settings }} />
</Layout>
